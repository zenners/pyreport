<html>
  <head>
    <style type="text/css">
      html,
      body {
        font-size: 12px;
        font-family: 'Segoe UI';
        background: #fff;
        padding: 0px;
        counter-reset: page;
      }
      #my-custom-table {
        width: 500px;
        border: 0;
        margin-top: 20px;
      }
      #my-custom-table td {
        padding: 5px 0px 1px 5px;
        text-align: left;
      }
      .new-page {
        page-break-before: always;
      }
      table {
        width: 100%;
      }
      table.auto {
        width: auto;
        font-size: 8px;
      }
      table.page-break {
        width: auto;
        font-size: 8px;
        page-break-after: always;
        border-bottom: 1px solid black;
      }
      th {
        border: 1px solid black;
        height: 50px;
        word-break: keep-all;
      }
      th.content {
        border: 1px solid black;
        font-size: 10px;
        height: auto;
        width: auto;
        word-break: keep-all;
      }
      th.header {
        border: 1px solid black;
        height: 50px;
        word-break: keep-all;
        margin-top: 10px
      }
      th.dfContent {
        border: 1px solid black;
        font-size: 10px;
        width: auto;
        height: auto;
        word-break: keep-all;
      }
      td.dfContent {
        border: 1px solid black;
        font-size: 10px;
        width: auto;
        height: auto;
        word-break: keep-all;
      }
      td.left {
        text-align: left;
      }
        td.center {
        text-align: center;
      }
      td {
        text-align: right;
        height: 30px;
        width: 50px;
        word-break: keep-all;
      }
      td.content {
        font-size: 8px;
        height: 20px;
        width: auto;
        word-break: keep-all;
      }
       tr:last-child td.content {
        font-size: 8px;
        height: 20px;
        width: auto;
        word-break: keep-all;
        font-weight: bold;
        border-top: 1px solid black;
      }
      td.header {
        text-align: right;
        height: 20px;
        word-break: keep-all;
      }
      td.xlong {
        min-width: 300px;
      }
      td.long {
        min-width: 160px;
      }
      td.medium {
        min-width: 80px;
      }
      td.small {
       min-width: 40px;
      }
      tr.border_top td {
        border-top:1pt solid black;
      }
      #paging::before {
        counter-increment: page;
        content: "Page " counter(page);
       }
       #pageCounter {
          counter-reset: pageTotal;
        }
        #pageCounter span {
          counter-increment: pageTotal;
        }
        #pageNumbers div:before {
          counter-increment: currentPage;
          content: " of ";
        }
        #pageNumbers div:after {
          content: counter(pageTotal);
        }

    </style>
  </head>
  <body>


    {% for results in df %}
     <table cellspacing="0" border="0" style="border:0; font-size: 12px ; margin-bottom: 5px;">
      <tr class="header">
        <td style="text-align:left;" class="header">
          <b><span>RFSC</span></b>
        </td>
        <td style="text-align:right;" class="header">
          <span>Date Generated: {{ date }}</span>
        </td>
      </tr>
     <tr>
        <td style="text-align:left;" class="header">
          <b><span>AGING REPORT</span></b>
        </td>
        <td style="text-align:right;" class="header">
          <span>Generated By: {{ name }}</span>
        </td>
     </tr>
     <tr>
        <td style="text-align:left;" class="header">
          <span>{{ range }}</span>
        </td>
        <td style="text-align:right;" class="header">
          <span>Time Generated: {{ time }}</span>
        </td>
    </tr>
    <tr>
        <td style="text-align:left;" class="header">
          <span>Nationwide</span>
        </td>
        <td colspan="5" style="text-align:right;" id="pageCounter">
            {% for results in df %}
                <span></span>
            {% endfor %}
            <div id="pageNumbers">
              <span id="paging"> </span><div style="display:inline-block;" class="page-number"></div>
            </div>
        </td>
    </tr>
    </table>
    <table cellspacing="0" border="0" class="page-break">
      <thead>
        <tr>
          {% for header in headers %}
          <th rowspan="2" class="dfContent">{{ header }}</th>
          {% endfor %}
        <th rowspan="1" colspan="8" class="dfContent">PAST DUE</th>
        <th rowspan="2" class="dfContent">TOTAL DUE</th>
            <th rowspan="1" colspan="4" class="dfContent">PAST DUE BREAKDOWN</th>
        <tr>
          <td class="dfContent center">1-30</td>
          <td class="dfContent center">31-60</td>
          <td class="dfContent center">61-90</td>
           <td class="dfContent center">91-120</td>
          <td class="dfContent center">121-150</td>
          <td class="dfContent center">151-180</td>
          <td class="dfContent center">181-360</td>
          <td class="dfContent center">OVER 360</td>
          <td class="dfContent center">PRINCIPAL</td>
          <td class="dfContent center">INTEREST</td>
          <td class="dfContent center">PENALTY</td>
          <td class="dfContent center">TOTAL</td>
        </tr>
      </thead>

      <tbody>
        {% for k,v in results.iterrows() %}
        <tr>
          <td class="content left">{{ v["num"] }}</td>
          <td class="content left">{{ v["channelName"] }}</td>
          <td class="content left">{{ v["partnerCode"] }}</td>
          <td class="content left">{{ v["outletCode"] }}</td>
          <td class="content">{{ v["appId"] }}</td>
          <td class="content">{{ v["loanAccountNumber"] }}</td>
          <td class="content">{{ v["newCustomerName"] }}</td>
          <td class="content">{{ v["alias"] }}</td>
          <td class="content">{{ v["fdd"] }}</td>
          <td class="content">{{ v["lastPaymentDate"] }}</td>
          <td class="content">{{ v["term"] }}</td>
          <td class="content">{{ v["expiredTerm"] }}</td>

          <td class="content">{{ v["monthlyInstallment"] }}</td>
          <td class="content">{{ v["stats"] }}</td>
          <td class="content">{{ v["ob"] }}</td>
          <td class="content">{{ v["runningMLV"] }}</td>
          <td class="content">{{ v["bucketing"] }}</td>
          <td class="content">{{ v["today"] }}</td>
          <td class="content">{{ v["1-30"] }}</td>
          <td class="content">{{ v["31-60"] }}</td>
          <td class="content">{{ v["61-90"] }}</td>
          <td class="content">{{ v["91-120"] }}</td>
          <td class="content">{{ v["121-150"] }}</td>
          <td class="content">{{ v["151-180"] }}</td>
          <td class="content">{{ v["181-360"] }}</td>
          <td class="content">{{ v["360 & over"] }}</td>
          <td class="content">{{ v["total"] }}</td>
          <td class="content">{{ v["duePrincipal"] }}</td>
          <td class="content">{{ v["dueInterest"] }}</td>
          <td class="content">{{ v["duePenalty"] }}</td>
          <td class="content">{{ v["amountSum"] }}</td>
        </tr>
        {% endfor %} {% endfor %}
      </tbody>
         <tbody>

         <tr>
          <td class="content"></td>
          <td colspan="2" class="content left">GRAND TOTAL:</td>
          <td class="content"></td>
          <td class="content"></td>
          <td class="content"></td>
          <td class="content"></td>
          <td class="content"></td>
          <td class="content"></td>
          <td class="content"></td>
          <td class="content"></td>
          <td class="content"></td>
          <td class="content">{{ summonthlyInstallment }}</td>
          <td class="content"></td>
          <td class="content">{{ sumob }}</td>
          <td class="content">{{ sumrunningMLV }}</td>
          <td class="content"></td>
          <td class="content">{{ sumtoday }}</td>
          <td class="content">{{ sum1 }}</td>
          <td class="content">{{ sum30 }}</td>
          <td class="content">{{ sum61 }}</td>
          <td class="content">{{ sum91 }}</td>
          <td class="content">{{ sum121 }}</td>
          <td class="content">{{ sum151 }}</td>
          <td class="content">{{ sum181 }}</td>
          <td class="content">{{ sum360 }}</td>
          <td class="content">{{ sumtotal }}</td>
          <td class="content">{{ sumduePrincipal }}</td>
          <td class="content">{{ sumdueInterest }}</td>
          <td class="content">{{ sumduePenalty }}</td>
          <td class="content">{{ sumamountSum}}</td>

        </tr>
      </tbody>
    </table>
  </body>
</html>
